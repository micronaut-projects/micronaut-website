<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    

    <meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
	<style>img:is([sizes="auto" i], [sizes^="auto," i]) { contain-intrinsic-size: 3000px 1500px }</style>
	
	<!-- This site is optimized with the Yoast SEO plugin v26.3 - https://yoast.com/wordpress/plugins/seo/ -->
	<title>Micronaut AOP: Awesome Flexibility Without the Complexity - Micronaut Framework</title>
	<meta name="description" content="Learn more about Micronaut&#039;s AOP system and how easy it is to use compared to competitors." />
	<link rel="canonical" href="/2019/10/07/micronaut-aop-awesome-flexibility-without-the-complexity/" />
	<meta property="og:locale" content="en_US" />
	<meta property="og:type" content="article" />
	<meta property="og:title" content="Micronaut AOP: Awesome Flexibility Without the Complexity - Micronaut Framework" />
	<meta property="og:description" content="Learn more about Micronaut&#039;s AOP system and how easy it is to use compared to competitors." />
	<meta property="og:url" content="/2019/10/07/micronaut-aop-awesome-flexibility-without-the-complexity/" />
	<meta property="og:site_name" content="Micronaut Framework" />
	<meta property="article:published_time" content="2019-10-07T12:48:57+00:00" />
	<meta property="article:modified_time" content="2021-08-02T18:05:52+00:00" />
	<meta property="og:image" content="/wp-content/uploads/2018/06/blog-featured-image-03.jpg" />
	<meta property="og:image:width" content="800" />
	<meta property="og:image:height" content="800" />
	<meta property="og:image:type" content="image/jpeg" />
	<meta name="author" content="Graeme Rocher" />
	<meta name="twitter:card" content="summary_large_image" />
	<meta name="twitter:label1" content="Written by" />
	<meta name="twitter:data1" content="Graeme Rocher" />
	<meta name="twitter:label2" content="Est. reading time" />
	<meta name="twitter:data2" content="11 minutes" />
	<script type="application/ld+json" class="yoast-schema-graph">{"@context":"https://schema.org","@graph":[{"@type":"WebPage","@id":"/2019/10/07/micronaut-aop-awesome-flexibility-without-the-complexity/","url":"/2019/10/07/micronaut-aop-awesome-flexibility-without-the-complexity/","name":"Micronaut AOP: Awesome Flexibility Without the Complexity - Micronaut Framework","isPartOf":{"@id":"/#website"},"primaryImageOfPage":{"@id":"/2019/10/07/micronaut-aop-awesome-flexibility-without-the-complexity/#primaryimage"},"image":{"@id":"/2019/10/07/micronaut-aop-awesome-flexibility-without-the-complexity/#primaryimage"},"thumbnailUrl":"/wp-content/uploads/2018/06/blog-featured-image-03.jpg","datePublished":"2019-10-07T12:48:57+00:00","dateModified":"2021-08-02T18:05:52+00:00","author":{"@id":"/#/schema/person/3ad84bb0e1cb3cbb0e20afb19f49eca1"},"description":"Learn more about Micronaut's AOP system and how easy it is to use compared to competitors.","breadcrumb":{"@id":"/2019/10/07/micronaut-aop-awesome-flexibility-without-the-complexity/#breadcrumb"},"inLanguage":"en-US","potentialAction":[{"@type":"ReadAction","target":["/2019/10/07/micronaut-aop-awesome-flexibility-without-the-complexity/"]}]},{"@type":"ImageObject","inLanguage":"en-US","@id":"/2019/10/07/micronaut-aop-awesome-flexibility-without-the-complexity/#primaryimage","url":"/wp-content/uploads/2018/06/blog-featured-image-03.jpg","contentUrl":"/wp-content/uploads/2018/06/blog-featured-image-03.jpg","width":800,"height":800},{"@type":"BreadcrumbList","@id":"/2019/10/07/micronaut-aop-awesome-flexibility-without-the-complexity/#breadcrumb","itemListElement":[{"@type":"ListItem","position":1,"name":"Home","item":"/"},{"@type":"ListItem","position":2,"name":"Blog","item":"/blog/"},{"@type":"ListItem","position":3,"name":"Micronaut AOP: Awesome Flexibility Without the Complexity"}]},{"@type":"WebSite","@id":"/#website","url":"/","name":"Micronaut Framework","description":"A modern, JVM-based, full-stack framework for building modular, easily testable microservice and serverless applications","potentialAction":[{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"/?s={search_term_string}"},"query-input":{"@type":"PropertyValueSpecification","valueRequired":true,"valueName":"search_term_string"}}],"inLanguage":"en-US"},{"@type":"Person","@id":"/#/schema/person/3ad84bb0e1cb3cbb0e20afb19f49eca1","name":"Graeme Rocher"}]}</script>
	<!-- / Yoast SEO plugin. -->


<link rel='dns-prefetch' href='//js.stripe.com' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel="alternate" type="application/rss+xml" title="Micronaut Framework &raquo; Micronaut AOP: Awesome Flexibility Without the Complexity Comments Feed" href="/2019/10/07/micronaut-aop-awesome-flexibility-without-the-complexity/feed/" />
<script type="text/javascript">
/* <![CDATA[ */
window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/16.0.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/16.0.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/micronaut.io\/wp-includes\/js\/wp-emoji-release.min.js?ver=6.8.3"}};
/*! This file is auto-generated */
!function(s,n){var o,i,e;function c(e){try{var t={supportTests:e,timestamp:(new Date).valueOf()};sessionStorage.setItem(o,JSON.stringify(t))}catch(e){}}function p(e,t,n){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);var t=new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data),a=(e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(n,0,0),new Uint32Array(e.getImageData(0,0,e.canvas.width,e.canvas.height).data));return t.every(function(e,t){return e===a[t]})}function u(e,t){e.clearRect(0,0,e.canvas.width,e.canvas.height),e.fillText(t,0,0);for(var n=e.getImageData(16,16,1,1),a=0;a<n.data.length;a++)if(0!==n.data[a])return!1;return!0}function f(e,t,n,a){switch(t){case"flag":return n(e,"\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f","\ud83c\udff3\ufe0f\u200b\u26a7\ufe0f")?!1:!n(e,"\ud83c\udde8\ud83c\uddf6","\ud83c\udde8\u200b\ud83c\uddf6")&&!n(e,"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f","\ud83c\udff4\u200b\udb40\udc67\u200b\udb40\udc62\u200b\udb40\udc65\u200b\udb40\udc6e\u200b\udb40\udc67\u200b\udb40\udc7f");case"emoji":return!a(e,"\ud83e\udedf")}return!1}function g(e,t,n,a){var r="undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?new OffscreenCanvas(300,150):s.createElement("canvas"),o=r.getContext("2d",{willReadFrequently:!0}),i=(o.textBaseline="top",o.font="600 32px Arial",{});return e.forEach(function(e){i[e]=t(o,e,n,a)}),i}function t(e){var t=s.createElement("script");t.src=e,t.defer=!0,s.head.appendChild(t)}"undefined"!=typeof Promise&&(o="wpEmojiSettingsSupports",i=["flag","emoji"],n.supports={everything:!0,everythingExceptFlag:!0},e=new Promise(function(e){s.addEventListener("DOMContentLoaded",e,{once:!0})}),new Promise(function(t){var n=function(){try{var e=JSON.parse(sessionStorage.getItem(o));if("object"==typeof e&&"number"==typeof e.timestamp&&(new Date).valueOf()<e.timestamp+604800&&"object"==typeof e.supportTests)return e.supportTests}catch(e){}return null}();if(!n){if("undefined"!=typeof Worker&&"undefined"!=typeof OffscreenCanvas&&"undefined"!=typeof URL&&URL.createObjectURL&&"undefined"!=typeof Blob)try{var e="postMessage("+g.toString()+"("+[JSON.stringify(i),f.toString(),p.toString(),u.toString()].join(",")+"));",a=new Blob([e],{type:"text/javascript"}),r=new Worker(URL.createObjectURL(a),{name:"wpTestEmojiSupports"});return void(r.onmessage=function(e){c(n=e.data),r.terminate(),t(n)})}catch(e){}c(n=g(i,f,p,u))}t(n)}).then(function(e){for(var t in e)n.supports[t]=e[t],n.supports.everything=n.supports.everything&&n.supports[t],"flag"!==t&&(n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&n.supports[t]);n.supports.everythingExceptFlag=n.supports.everythingExceptFlag&&!n.supports.flag,n.DOMReady=!1,n.readyCallback=function(){n.DOMReady=!0}}).then(function(){return e}).then(function(){var e;n.supports.everything||(n.readyCallback(),(e=n.source||{}).concatemoji?t(e.concatemoji):e.wpemoji&&e.twemoji&&(t(e.twemoji),t(e.wpemoji)))}))}((window,document),window._wpemojiSettings);
/* ]]> */
</script>
<style id='wp-emoji-styles-inline-css' type='text/css'>

	img.wp-smiley, img.emoji {
		display: inline !important;
		border: none !important;
		box-shadow: none !important;
		height: 1em !important;
		width: 1em !important;
		margin: 0 0.07em !important;
		vertical-align: -0.1em !important;
		background: none !important;
		padding: 0 !important;
	}
</style>
<link rel='stylesheet' id='wp-block-library-css' href='/wp-includes/css/dist/block-library/style.min.css?ver=6.8.3' type='text/css' media='all' />
<style id='classic-theme-styles-inline-css' type='text/css'>
/*! This file is auto-generated */
.wp-block-button__link{color:#fff;background-color:#32373c;border-radius:9999px;box-shadow:none;text-decoration:none;padding:calc(.667em + 2px) calc(1.333em + 2px);font-size:1.125em}.wp-block-file__button{background:#32373c;color:#fff;text-decoration:none}
</style>
<style id='global-styles-inline-css' type='text/css'>
:root{--wp--preset--aspect-ratio--square: 1;--wp--preset--aspect-ratio--4-3: 4/3;--wp--preset--aspect-ratio--3-4: 3/4;--wp--preset--aspect-ratio--3-2: 3/2;--wp--preset--aspect-ratio--2-3: 2/3;--wp--preset--aspect-ratio--16-9: 16/9;--wp--preset--aspect-ratio--9-16: 9/16;--wp--preset--color--black: #000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #fff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--color--primary: #2559a7;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;--wp--preset--spacing--20: 0.44rem;--wp--preset--spacing--30: 0.67rem;--wp--preset--spacing--40: 1rem;--wp--preset--spacing--50: 1.5rem;--wp--preset--spacing--60: 2.25rem;--wp--preset--spacing--70: 3.38rem;--wp--preset--spacing--80: 5.06rem;--wp--preset--shadow--natural: 6px 6px 9px rgba(0, 0, 0, 0.2);--wp--preset--shadow--deep: 12px 12px 50px rgba(0, 0, 0, 0.4);--wp--preset--shadow--sharp: 6px 6px 0px rgba(0, 0, 0, 0.2);--wp--preset--shadow--outlined: 6px 6px 0px -3px rgba(255, 255, 255, 1), 6px 6px rgba(0, 0, 0, 1);--wp--preset--shadow--crisp: 6px 6px 0px rgba(0, 0, 0, 1);}:where(.is-layout-flex){gap: 0.5em;}:where(.is-layout-grid){gap: 0.5em;}body .is-layout-flex{display: flex;}.is-layout-flex{flex-wrap: wrap;align-items: center;}.is-layout-flex > :is(*, div){margin: 0;}body .is-layout-grid{display: grid;}.is-layout-grid > :is(*, div){margin: 0;}:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}
:where(.wp-block-post-template.is-layout-flex){gap: 1.25em;}:where(.wp-block-post-template.is-layout-grid){gap: 1.25em;}
:where(.wp-block-columns.is-layout-flex){gap: 2em;}:where(.wp-block-columns.is-layout-grid){gap: 2em;}
:root :where(.wp-block-pullquote){font-size: 1.5em;line-height: 1.6;}
</style>
<link rel='stylesheet' id='modal-window-css' href='/wp-content/plugins/modal-window/public/assets/css/modal.min.css?ver=6.2.3' type='text/css' media='all' />
<link rel='stylesheet' id='fonts-fira-sans-css' href='//fonts.googleapis.com/css2?family=Fira+Sans%3Awght%40300%3B500&#038;display=swap&#038;ver=6.8.3' type='text/css' media='all' />
<link rel='stylesheet' id='micronaut-style-css' href='/wp-content/themes/micronaut/style.min.css?ver=6.8.3' type='text/css' media='all' />
<script type="text/javascript" src="/wp-includes/js/jquery/jquery.min.js?ver=3.7.1" id="jquery-core-js"></script>
<script type="text/javascript" src="/wp-includes/js/jquery/jquery-migrate.min.js?ver=3.4.1" id="jquery-migrate-js"></script>
<script type="text/javascript" src="//js.stripe.com/v3/?ver=6.8.3" id="stripe-js"></script>
<link rel="https://api.w.org/" href="/wp-json/" /><link rel="alternate" title="JSON" type="application/json" href="/wp-json/wp/v2/posts/2970" /><link rel="EditURI" type="application/rsd+xml" title="RSD" href="/xmlrpc.php?rsd" />
<meta name="generator" content="WordPress 6.8.3" />
<link rel='shortlink' href='/?p=2970' />
<link rel="alternate" title="oEmbed (JSON)" type="application/json+oembed" href="/wp-json/oembed/1.0/2019/10/07/micronaut-aop-awesome-flexibility-without-the-complexity/embed.json" />
<link rel="alternate" title="oEmbed (XML)" type="text/xml+oembed" href="/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fmicronaut.io%2F2019%2F10%2F07%2Fmicronaut-aop-awesome-flexibility-without-the-complexity%2F&#038;format=xml" />
<link rel="icon" href="/wp-content/uploads/2021/02/favicon.ico" type="image/png"><link rel="shortcut icon" href="/wp-content/uploads/2021/02/favicon.ico" type="image/png"><meta name="theme-color" content="#000000"><script type="text/javascript">var STRIPE_PUBLISHABLE_KEY = "pk_live_51HMxCnAdio0y30LTv9S4fLlYVaBdZN5ihurBPL6kJ8fQNbN3jRj6JwJQNXeL7PhZTQvuGcmWOdoyIUsuqXaop8OK00qddh873V";</script><script type="text/javascript">var TRIGGER_SUBSCRIBE = false;</script><link rel="icon" href="/wp-content/uploads/2025/09/favicon-120x120.png" sizes="32x32" />
<link rel="icon" href="/wp-content/uploads/2025/09/favicon-300x300.png" sizes="192x192" />
<link rel="apple-touch-icon" href="/wp-content/uploads/2025/09/favicon-300x300.png" />
<meta name="msapplication-TileImage" content="/wp-content/uploads/2025/09/favicon-300x300.png" />
		<style type="text/css" id="wp-custom-css">
			.fa-x-twitter:before {
  content: "\e61b"; }
p.expand-bottom-margin {
	margin-bottom: 32px;
}

h2.expand-bottom-margin,
h3.expand-bottom-margin,
h4.expand-bottom-margin,
h5.expand-bottom-margin,
h6.expand-bottom-margin {
	margin-bottom: 20px;
}

.underline {
	text-decoration:underline;
}

h2.natural-case,
h3.natural-case,
h4.natural-case,
h5.natural-case,
h6.natural-case {
	text-transform: none !important;
}

.legal-list {
	list-style-type: '§';
}

.quote {
	border-top: 2px solid black; 
	border-bottom: 2px solid black;
	margin: 18px auto;
	padding:15px 15px 0 15px;
	background-color: #f5f5f5;
}

blockquote {
	display: block;
	border-left: 5px solid black;
	padding-left: 20px;
}

blockquote, q {
	quotes: none;
}

figure {
	padding: 20px;
}
.figurepink {
	padding: 3px;
	background: #FF0096;
	color: #FFFFFF;
}
.figureorange {
	padding: 3px;
	background: #FF8A00;
	color: #FFFFFF;
}
.figureblue {
	padding: 3px;
	background: #004EFF;
	color: #FFFFFF;
}		</style>
		
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-115754405-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-115754405-1');
    </script>

  </head>
  <body class="wp-singular post-template-default single single-post postid-2970 single-format-standard wp-theme-micronaut">

    <header id="header">

      
      <div class="container">

        <nav class="navbar navbar-expand-lg navbar-dark">

          <button class="collapsed" type="button" data-toggle="collapse" data-target="#nav" aria-expanded="false">
            <span></span>
          </button>

          <a class="navbar-brand" href="/">
            <img src="/wp-content/uploads/2020/11/MIcronautLogo_Horizontal.svg" alt="Micronaut Framework" />
          </a>

          <div class="collapse navbar-collapse" id="nav">

            <ul class="navbar-nav ml-auto">

              <li id="menu-item-2865" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2865 nav-item"><a href="/download/" class="nav-link">Download</a></li>
<li id="menu-item-2868" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-2868 dropdown nav-item"><a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Learn</a><ul class="dropdown-menu">
	<li id="menu-item-4943" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4943"><a href="/learn/" class="dropdown-item">Overview</a></li>
	<li id="menu-item-5111" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5111"><a href="https://docs.micronaut.io/index.html" class="dropdown-item">User Documentaton</a></li>
	<li id="menu-item-4510" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4510"><a href="/guides/" class="dropdown-item">Guides</a></li>
	<li id="menu-item-7373" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-7373"><a href="https://mylearn.oracle.com/ou/course/micronaut-fundamentals/151938/" class="dropdown-item">Micronaut Fundamentals</a></li>
	<li id="menu-item-2896" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2896"><a href="/category/microcast/" class="dropdown-item">Microcasts</a></li>
	<li id="menu-item-2897" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-2897"><a href="/category/webinar/" class="dropdown-item">Webinars</a></li>
	<li id="menu-item-2871" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2871"><a href="/professional-training/" class="dropdown-item">Professional Training</a></li>
	<li id="menu-item-6526" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6526"><a href="https://micronaut-projects.github.io/micronaut-guides-mn3/latest/" class="dropdown-item">Guides for Micronaut Framework 3</a></li>
</ul>
</li>
<li id="menu-item-2878" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-2878 dropdown nav-item"><a href="/resources/" class="nav-link dropdown-toggle" data-toggle="dropdown">Resources</a><ul class="dropdown-menu">
	<li id="menu-item-4999" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4999"><a href="/upcoming-events/" class="dropdown-item">Upcoming Events</a></li>
	<li id="menu-item-2879" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-2879"><a href="/blog/" class="dropdown-item">Blog</a></li>
	<li id="menu-item-6478" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6478"><a href="/category/release-announcements/" class="dropdown-item">Releases</a></li>
	<li id="menu-item-6861" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6861"><a href="/micronaut-roadmap/" class="dropdown-item">Micronaut ROADMAP</a></li>
	<li id="menu-item-6715" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-6715"><a href="/category/security-announcements/" class="dropdown-item">Security Announcements</a></li>
	<li id="menu-item-4499" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4499"><a href="https://micronautpodcast.com/" class="dropdown-item">Podcast</a></li>
	<li id="menu-item-5798" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-5798"><a href="/support/" class="dropdown-item">Commercial Support</a></li>
	<li id="menu-item-4186" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4186"><a href="/resources/community-support/" class="dropdown-item">Community Support</a></li>
	<li id="menu-item-2882" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2882"><a href="/faq/" class="dropdown-item">FAQ</a></li>
	<li id="menu-item-2883" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2883"><a href="/contact/" class="dropdown-item">Contact</a></li>
	<li id="menu-item-6479" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6479"><a href="/micronaut-success-stories/" class="dropdown-item">Micronaut Success Stories</a></li>
</ul>
</li>
<li id="menu-item-2872" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-has-children menu-item-2872 dropdown nav-item"><a href="/foundation/" class="nav-link dropdown-toggle" data-toggle="dropdown">Foundation</a><ul class="dropdown-menu">
	<li id="menu-item-2877" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2877"><a href="/foundation/" class="dropdown-item">Overview</a></li>
	<li id="menu-item-2874" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2874"><a href="/foundation/corporate-sponsorship/" class="dropdown-item">Corporate Sponsorship</a></li>
	<li id="menu-item-2873" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2873"><a href="/foundation/community-sponsorship/" class="dropdown-item">Community Sponsorship</a></li>
	<li id="menu-item-2876" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2876"><a href="/foundation/sponsors/" class="dropdown-item">Sponsors</a></li>
	<li id="menu-item-3838" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-3838"><a href="/meeting-minutes/" class="dropdown-item">Meeting Minutes</a></li>
</ul>
</li>
<li id="menu-item-2884" class="action menu-item menu-item-type-custom menu-item-object-custom menu-item-2884 nav-item"><a target="_blank" href="/launch/" class="nav-link">Launch</a></li>

            </ul>

          </div>

        </nav>

      </div>
    </header>

    
<div id="contact" class="flyout collapse">
  <div class="container">

    <div class="inner">

      <button type="button" data-toggle="collapse" data-target="#contact" class="close">&times;</button>

      <div class="row justify-content-end">
        <div class="col-md-4"><div class="widget"><h4>Contact Us About Sponsorship</h4>			<div class="textwidget"><p>Questions about Micronaut Foundation sponsorship?</p>
<p>Please complete this form, and we’ll follow up with you shortly.</p>
</div>
		</div></div><div class="col-md-4"><div class="widget">			<div class="textwidget"><p>[hubspot type=form portal=4547412 id=a7b3ddfa-64b0-47fd-8358-45fa6a09456a]</p>
</div>
		</div></div> 
      </div>

    </div>

  </div>
</div>

<div id="breadcrumbs"><div class="container"><span><span><a href="/">Home</a></span> » <span><a href="/blog/">Blog</a></span> » <span class="breadcrumb_last" aria-current="page">Micronaut AOP: Awesome Flexibility Without the Complexity</span></span></div></div>
<main id="main">
  <div class="container">
    
    <div class="row">
      <div class="col-sm-8">
        
                  
        
        <article class="post_single">
        
          <header>
            
            <h1>Micronaut AOP: Awesome Flexibility Without the Complexity</h1>
            
            <span>by Graeme Rocher</span>
            
            <span class="tags">Tags: <a href="/tag/aop/" rel="tag">aop</a></span>            
            <time>October 7, 2019</time>
            
          </header>
          
                    <p class="excerpt">Learn more about Micronaut's AOP system and how easy it is to use compared to competitors.</p>
                    
          <p>With the recent release of <a href="https://github.com/micronaut-projects/micronaut-data/releases/tag/v1.0.0.M2">Micronaut Data 1.0 M3</a>, I got to work on a couple of features for Micronaut Data that really highlighted to me what we have achieved with <a href="https://docs.micronaut.io/latest/guide/index.html#aop">Micronaut&#8217;s aspect-oriented programming (AOP) API</a> and the fantastic simplifications it offers, while at the same time ensuring optimal performance. I thought I would take the time to do a write-up of how Micronaut AOP works and why it is one of my favorite Micronaut features compared to the competitors.</p>
<h2>Introduction to AOP</h2>
<p>For those unfamiliar, AOP has a long history in the Java community, with a variety of different implementations, including a custom Java language extension called <a href="https://www.eclipse.org/aspectj/">AspectJ</a>. The basic idea is that in a Java application, you often want to apply cross-cutting logic to a method invocation. The way you apply this cross-cutting logic could be expressed in a custom language like AspectJ; however most developers are exposed to AOP via annotations, where you explicitly apply AOP &#8220;advice&#8221; to a method.</p>
<p>The most famous example of this in the Java community is probably Spring&#8217;s <code>@Transactional</code> annotation, which allows you to demarcate a method as running within the context of a declared transaction. This is what is known as &#8220;Around Advice,&#8221; where you decorate a method invocation with new behavior that implements a cross-cutting concern.</p>
<p>Around Advice is just one type of AOP Advice supported by Micronaut. The following advice types are supported:</p>
<ul>
<li><strong><a href="https://docs.micronaut.io/latest/guide/index.html#aroundAdvice">Around Advice</a>.</strong> As described previously, you decorate an existing method with new behavior.</li>
<li><strong><a href="https://docs.micronaut.io/latest/guide/index.html#introductionAdvice">Introduction Advice</a>.</strong> Introduction Advice differs, in that it allows you to introduce new behavior to an existing class. A great example of this is, in fact, Micronaut Data (and Spring Data), which allows you to declare an interface that the compiler implements for you by introducing new behavior.</li>
<li><strong><a href="https://docs.micronaut.io/latest/guide/index.html#adapterAdvice">Adapter Advice</a>.</strong> Adapter Advice is, I believe, unique to Micronaut in that it allows you to introduce a new bean that implements SAM type, an interface with a single abstract method, and delegates to any method definition. This may sound confusing, but shortly I will present a concrete example of this in action.</li>
</ul>
<p>So why does Micronaut implement its own AOP mechanism, rather than rely on something already out there?</p>
<p>Existing implementations for both Java/Jakarta EE and Spring rely heavily on a mixture of runtime reflection, JDK proxies, and byte code generation with something like CGLib or Bytebuddy (even Quarkus currently only implements reflection-free DI and not AOP).</p>
<p>Micronaut dependency injection is completely reflection free, so it made sense for Micronaut&#8217;s AOP mechanism to be reflection free as well.</p>
<h2>Micronaut AOP Setup</h2>
<p>Micronaut AOP is incredibly simple to use when compared to other implementations out there. It is literally just a compiler feature. There is no need to set up complex ProxyFactoryBean implementations or rely on a runtime container. The minimum set of requirements to get going with Micronaut AOP is to add the Micronaut annotation processors and declare a dependency on micronaut-aop in your build.</p>
<p>The following is the Gradle configuration required:</p>
<pre><code class="language-groovy">dependencies {
     annotationProcessor "io.micronaut:micronaut-inject-java:$micronautVersion"
     compile "io.micronaut:micronaut-aop:$micronautVersion"
}
</code></pre>
<p>And the equivalent Maven config:</p>
<pre><code class="language-xml">&lt;dependencies&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;io.micronaut&lt;/groupId&gt;
      &lt;artifactId&gt;micronaut-aop&lt;/artifactId&gt;
      &lt;scope&gt;compile&lt;/scope&gt;
      &lt;version&gt;${micronaut.version}&lt;/version&gt;
    &lt;/dependency&gt;
....
    &lt;pluginManagement&gt;
      &lt;plugins&gt;
        &lt;plugin&gt;
          &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
          &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
          &lt;version&gt;3.7.0&lt;/version&gt;
          &lt;configuration&gt;
            &lt;source&gt;${jdk.version}&lt;/source&gt;
            &lt;target&gt;${jdk.version}&lt;/target&gt;
            &lt;encoding&gt;UTF-8&lt;/encoding&gt;
            &lt;compilerArgs&gt;
              &lt;arg&gt;-parameters&lt;/arg&gt;
            &lt;/compilerArgs&gt;
            &lt;annotationProcessorPaths&gt;
                  &lt;path&gt;
                    &lt;groupId&gt;io.micronaut&lt;/groupId&gt;
                    &lt;artifactId&gt;micronaut-inject-java&lt;/artifactId&gt;
                    &lt;version&gt;${micronaut.version}&lt;/version&gt;
                  &lt;/path&gt;
            &lt;/annotationProcessorPaths&gt;
</code></pre>
<p>The Maven configuration requires you declare the micronaut-inject-java dependency in your annotation processors paths from the Maven compiler plugin.</p>
<h2>Micronaut Around Advice Put to Use</h2>
<p>So as mentioned at the beginning of the article, I got to use some of the Micronaut AOP features with Micronaut Data, since we wanted to support transaction management, as well as transactional events, without the need to pull in Spring, which adds overhead by introducing an additional 4mb of dependencies, makes extensive use of reflection and runtime proxies, which impact memory consumption, and negatively impacts GraalVM native support.</p>
<p>The first step was to add support for <code>javax.transaction.Transactional</code> so you could use the standard Java annotation to declare transaction boundaries. To achieve this, I created a new annotation called <a href="https://github.com/micronaut-projects/micronaut-data/blob/master/data-tx/src/main/java/io/micronaut/transaction/annotation/TransactionalAdvice.java">TransactionalAdvice</a>, which I declared as a meta-annotation (an annotation that can be used only on other annotations):</p>
<pre><code class="language-java">@Target(ElementType.ANNOTATION_TYPE)
@Retention(RetentionPolicy.RUNTIME)
@Around
@Type(TransactionalInterceptor.class)
@Internal
public @interface TransactionalAdvice {
    /**
     * Alias for {@link #transactionManager}.
     *
     * @return The transaction manager
     * @see #transactionManager
     */
    String value() default "";

    // Remaining members omitted for clarity

}
</code></pre>
<p>The <code>TransactionalAdvice</code> annotation is itself annotated with <a href="https://docs.micronaut.io/latest/api/io/micronaut/aop/Around.html">@Around</a> and <code>@Type(TransactionalInterceptor.class)</code>, which indicate the interceptor type that will handle the method invocation.</p>
<p>To make it possible to activate the <code>TransactionAdvice</code> behavior every time someone uses <code>javax.transaction.Transactional</code>, I then added a <code>AnnotationMapper</code> that the compiler will use to map the <code>javax.transaction.Transactional</code> annotation to the <code>TransactionAdvice</code> annotation:</p>
<pre><code class="language-java">public class JtaTransactionalMapper implements NamedAnnotationMapper {
    @NonNull
    @Override
    public String getName() {
        return "javax.transaction.Transactional";
    }

    @Override
    public List&lt;AnnotationValue&lt;?&gt;&gt; map(AnnotationValue&lt;Annotation&gt; annotation, VisitorContext visitorContext) {

        AnnotationValueBuilder&lt;Annotation&gt; builder =
                AnnotationValue.builder("io.micronaut.transaction.interceptor.annotation.TransactionalAdvice");

        // Member processing omitted for brevity....

        return Collections.singletonList(
                builder.build()
        );
    }
}
</code></pre>
<p>The above annotation mapper will be triggered every time a <code>@Transactional</code> annotation is declared in code. The map method returns the meta annotation that the annotation maps to.</p>
<p>The motivation to use a meta-annotation and map existing annotations is that you can support any annotation type, including Spring&#8217;s. Additionally, if one day <code>javax.transaction</code> is renamed to <code>jakarta.transaction</code>, we just add a new mapper that has zero runtime overhead. It allows Micronaut to completely decouple itself from the source code annotation DSL used.</p>
<p>So what about the <a href="https://github.com/micronaut-projects/micronaut-data/blob/master/data-tx/src/main/java/io/micronaut/transaction/interceptor/TransactionalInterceptor.java">TransactionInterceptor</a> implementation?</p>
<p>Micronaut AOP defines an interface called <a href="https://docs.micronaut.io/latest/api/io/micronaut/aop/MethodInterceptor.html">MethodInterceptor</a> that features a single method called <code>intercept</code> that all interceptors need to implement. The intercept method receives a reference to the <a href="https://docs.micronaut.io/latest/api/io/micronaut/aop/MethodInvocationContext.html">MethodInvocationContext</a> that holds a reference to the <a href="https://docs.micronaut.io/latest/api/io/micronaut/inject/ExecutableMethod.html">ExecutableMethod</a> that you can use to proceed and invoke the original implementation.</p>
<p>The received <code>ExecutableMethod</code> is a compile-time-produced handle that allows you to invoke the original method without using reflection. It also contains a reference to the <a href="https://docs.micronaut.io/latest/api/io/micronaut/core/annotation/AnnotationMetadata.html">AnnotationMetadata</a>, which allows you to inspect and retrieve annotation values and stereotypes without using reflection. The benefits of this include massively reduced stack trace sizes, improved performance, and reduced memory consumption.</p>
<p>The following is the implementation taken from the <code>TransactionInterceptor</code>:</p>
<pre><code class="language-php">public Object intercept(MethodInvocationContext&lt;Object, Object&gt; context) {
    final TransactionInvocation transactionInvocation = transactionInvocationMap
            .computeIfAbsent(context.getExecutableMethod(), executableMethod -&gt; {
        final String qualifier = executableMethod.stringValue(TransactionalAdvice.class).orElse(null);
        SynchronousTransactionManager transactionManager =
                beanLocator.getBean(SynchronousTransactionManager.class, qualifier != null ? Qualifiers.byName(qualifier) : null);
        final TransactionAttribute transactionAttribute = resolveTransactionDefinition(executableMethod);

        return new TransactionInvocation(transactionManager, transactionAttribute);
    });
    final TransactionAttribute definition = transactionInvocation.definition;
    final SynchronousTransactionManager transactionManager = transactionInvocation.transactionManager;
    final TransactionInfo transactionInfo = createTransactionIfNecessary(
            transactionManager,
            definition,
            definition.getName());
    Object retVal;
    try {
        retVal = context.proceed();
    } catch (Throwable ex) {
        completeTransactionAfterThrowing(transactionInfo, ex);
        throw ex;
    } finally {
        cleanupTransactionInfo(transactionInfo);
    }
    commitTransactionAfterReturning(transactionInfo);
    return retVal;
}
</code></pre>
<p>The important aspects start on line 4, where the annotation metadata is inspected to figure out which transaction manager to look up to apply transaction management.</p>
<p>On line 13, a transaction is created. We then proceed within the method invocation on line 19 and finally return the value on line 27. The code here is largely based on the equivalent code in Spring&#8217;s <code>TransactionAspectSupport</code>, but without needing all of the runtime proxy and reflection complexity.</p>
<p>And with that, whenever you declare <code>@Transactional</code> in your code, you get automatic transaction management. Nothing else to configure. How simple is that?</p>
<h2>Micronaut Introduction Advice Put to Use</h2>
<p>Another feature requested by Micronaut users is the ability get a reference to a <code>java.sql.Connection</code> that is aware of the currently executing transaction. The solution for this in Spring is <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/jdbc/datasource/TransactionAwareDataSourceProxy.html">TransactionAwareDataSourceProxy</a>, which proxies your entire <code>java.sql.DataSource</code>, making sure whenever you retrieve a connection, it is associated with the current transaction. But this adds the overhead of runtime reflection and proxying to all methods of the <code>DataSource</code> interface.</p>
<p>To support this use case without proxying the <code>DataSource</code>, with Micronaut Data we decided to allow users to inject a transaction-aware <code>java.sql.Connection</code> in a similar way you can inject a transaction-aware <code>EntityManager</code> in JPA that uses Hibernate&#8217;s <code>getCurrentSession()</code> feature.</p>
<p>This turned out to be really simple with Micronaut AOP. The first step was to define an interface that extended <code>java.sql.Connection</code>, which I called <a href="https://github.com/micronaut-projects/micronaut-data/blob/master/data-tx/src/main/java/io/micronaut/transaction/jdbc/TransactionalConnection.java">TransactionalConnection</a>:</p>
<pre><code class="language-java">package io.micronaut.transaction.jdbc;

import io.micronaut.context.annotation.EachBean;
import javax.sql.DataSource;
import java.sql.Connection;

@EachBean(DataSource.class)
@ConnectionAdvice
public interface TransactionalConnection extends Connection {
}
</code></pre>
<p>The interface is annotated on line 7 with another of my favorite Micronaut features, the <a href="https://docs.micronaut.io/latest/api/io/micronaut/context/annotation/EachBean.html">@EachBean</a> annotation, which says that for every <code>DataSource</code> bean configured in the application, create an associated <code>TransactionalConnection</code> bean. This effectively means if you have multiple data sources, you get a <code>TransactionalConnection</code> bean configured for each one automatically and use a <code>javax.inject.Named</code> qualifier to inject the one you want.</p>
<p>The Introduction Advice is then defined on line 8 using a new annotation called <code>@ConnectionAdvice</code>, which is a package private internal annotation and looks like the following:</p>
<pre><code class="language-php">@Retention(RUNTIME)
@Introduction
@Type(ConnectionInterceptor.class)
@Internal
@interface ConnectionAdvice {
}
</code></pre>
<p>On line 3, we define the annotation as <a href="https://docs.micronaut.io/latest/api/io/micronaut/aop/Introduction.html">@Introduction</a> Advice, which means it can implement abstract behavior.</p>
<p>On line 4, we define the interceptor that is going to provide the implementation at runtime, which in this case is ConnectionInterceptor, which is shown below and is really simple:</p>
<pre><code class="language-php">public final class ConnectionInterceptor implements MethodInterceptor&lt;Connection, Object&gt; {

    private final DataSource dataSource;

    ConnectionInterceptor(BeanContext beanContext, Qualifier&lt;DataSource&gt; qualifier) {
        this.dataSource = beanContext.getBean(DataSource.class, qualifier);
    }

    public Object intercept(MethodInvocationContext&lt;Connection, Object&gt; context) {
        Connection connection;
        try {
            connection = DataSourceUtils.getConnection(dataSource, false);
        } catch (CannotGetJdbcConnectionException e) {
            throw new NoTransactionException("No current transaction present. Consider declaring @Transactional on the surrounding method", e);
        }
        return context.getExecutableMethod().invoke(connection, context.getParameterValues());
    }
}
</code></pre>
<p>On line 6 we used the injected qualifier for the interceptor instance to look up the associated <code>DataSource</code>. Then on line 12 we look up the connection associated with the current transaction. If no connection is present, we throw <code>NoTransactionException</code> on line 14. Otherwise we proceed and invoke the method on the connection on line 16.</p>
<p>With that in place, all a user has to do is inject a Connection instance and use it directly, rather than having to manually look up the connection associated with the current transaction, which simplifies the code quite nicely:</p>
<pre><code class="language-java">@Inject
Connection connection;

@Transactional
void insertWithTransaction() throws Exception {
    try (PreparedStatement ps = connection
            .prepareStatement("insert into book (pages, title) values(100, 'The Stand')")) {
        ps.execute();
    }
}
</code></pre>
<p>The underlying connection is managed by the transaction and cleaned up and closed after the transaction commits, so there is no need to close it manually. If one were to remove the <code>@Transactional</code> definition, a <code>NoTransactionException</code> would occur.</p>
<h2>Micronaut Adapter Advice Put to Use</h2>
<p>Both Micronaut and Spring allow the publication of events that can be consumed by either synchronous or asynchronous event listeners.</p>
<p>One missing feature from Micronaut, which users have been asking for a lot, is the ability to define transactional event listeners. That is, event listeners that are only triggered when a particular transaction phase completes (typically users are most interested in triggering behavior after a successful commit). The use cases here are things like sending an email or publishing a Kafka message only if a transaction commits successfully.</p>
<p>Making this work in Micronaut was actually remarkably simple thanks to <a href="https://docs.micronaut.io/latest/guide/index.html#adapterAdvice">Adapter advice</a>.</p>
<p>The first step was defining a <a href="https://github.com/micronaut-projects/micronaut-data/blob/master/data-tx/src/main/java/io/micronaut/transaction/annotation/TransactionalEventListener.java">@TransactionalEventListener</a> annotation:</p>
<pre><code class="language-java">@Target({ElementType.METHOD, ElementType.ANNOTATION_TYPE})
@Retention(RetentionPolicy.RUNTIME)
@Documented
@Adapter(ApplicationEventListener.class)
@TransactionalEventAdvice
public @interface TransactionalEventListener {
    TransactionPhase value() default TransactionPhase.AFTER_COMMIT;
}
</code></pre>
<p>The first important part is the definition in the <a href="https://docs.micronaut.io/latest/api/io/micronaut/aop/Adapter.html">@Adapter</a> annotation on line 4, which takes the interface we want to adapt, in this case <a href="https://docs.micronaut.io/latest/api/io/micronaut/context/event/ApplicationEventListener.html">ApplicationEventListener</a>.</p>
<p>Interfaces passed to the <a href="https://docs.micronaut.io/latest/api/io/micronaut/aop/Adapter.html">@Adapter</a> annotation have to contain a Single Abstract Method (often called SAM types). At compilation time, Micronaut will create an additional bean that implements the interface and delegates to the method that declares the annotation. So in this case a new <code>ApplicationEventListener</code> bean will be created that invokes the method that <a href="https://github.com/micronaut-projects/micronaut-data/blob/master/data-tx/src/main/java/io/micronaut/transaction/annotation/TransactionalEventListener.java">@TransactionalEventListener</a> is declared on.</p>
<p>The nice thing is that if you try to declare <code>@TransactionalEventListener</code> on a method that doesn&#8217;t conform to the signature of the <code>ApplicationEventListener</code> interface, you will get a compilation error. This is part of Micronaut&#8217;s nice ability to compile time check what you are doing with the framework is correct.</p>
<p>In addition to the Adapter advice, the <code>@TransactionalEventListener</code> annotation also declares an <code>@Around</code> advice implementation on line 5 called <code>@TransactionalEventAdvice</code>, which looks like:</p>
<pre><code class="language-java">@Around
@Type(TransactionalEventInterceptor.class)
@Internal
public @interface TransactionalEventAdvice {
}
</code></pre>
<p>As you can see, on line 1, the <code>@TransactionEventAdvice</code> is declared as <code>@Around</code> advice (which remember allows decorating existing behavior), and on line 3, the type of advice is defined as <code>TransactionalEventInterceptor</code>.</p>
<p>The implementation of the <code>TransactionalEventInterceptor</code> is also really simple and intercepts the invocation of the event listener:</p>
<pre><code class="language-java">public Object intercept(MethodInvocationContext&lt;Object, Object&gt; context) {
    final TransactionalEventListener.TransactionPhase phase = context
            .enumValue(TransactionalEventListener.class, TransactionalEventListener.TransactionPhase.class)
            .orElse(TransactionalEventListener.TransactionPhase.AFTER_COMMIT);
    if (TransactionSynchronizationManager.isSynchronizationActive() &amp;&amp;
            TransactionSynchronizationManager.isActualTransactionActive()) {
        TransactionSynchronizationManager.registerSynchronization(new TransactionSynchronizationAdapter() {

            @Override
            public void beforeCommit(boolean readOnly) {
                if (phase == TransactionalEventListener.TransactionPhase.BEFORE_COMMIT) {
                    context.proceed();
                }
            }

            @Override
            public void afterCompletion(@NonNull Status status) {
                switch (status) {
                    case ROLLED_BACK:
                        if (phase == TransactionalEventListener.TransactionPhase.AFTER_ROLLBACK) {
                            context.proceed();
                        }
                    break;
                    case COMMITTED:
                        if (phase == TransactionalEventListener.TransactionPhase.AFTER_COMMIT) {
                            context.proceed();
                        }
                    break;
                    default:
                        if (phase == TransactionalEventListener.TransactionPhase.AFTER_COMPLETION) {
                            context.proceed();
                        }
                }
            }
        });
    } else {
        if (LOG.isDebugEnabled()) {
            LOG.debug("No active transaction, skipping event {}", context.getParameterValues()[0]);
        }
    }
    return null;
}
</code></pre>
<p>On line 2, the transaction phase the event applies to is looked up from the annotation metadata. Then on line 5, the interceptors checks if there is an active transaction. If there is no active transaction, the event listener is skipped on line 38. Otherwise on line 7, a new transaction synchronization is registered. Depending on the phase, the listener is only invoked via the proceed method when the appropriate transaction event occurs. For example, on transaction commit, the method will be invoked on line 26.</p>
<p>And with that we have working transactional events!</p>
<p>The following shows an example in action:</p>
<pre><code class="language-java">@Singleton
public class BookManager {
    private final BookRepository bookRepository;
    private final ApplicationEventPublisher eventPublisher;

    public BookManager(BookRepository bookRepository, ApplicationEventPublisher eventPublisher) {
        this.bookRepository = bookRepository;
        this.eventPublisher = eventPublisher;
    }

    @Transactional
    void saveBook(String title, int pages) {
        final Book book = new Book(title, pages);
        bookRepository.save(book);
        eventPublisher.publishEvent(new NewBookEvent(book));
    }

    @TransactionalEventListener
    void onNewBook(NewBookEvent event) {
        System.out.println("book = " + event.book);
    }

}
</code></pre>
<p>First, on line 6, the constructor of the class gets a reference to the <a href="https://docs.micronaut.io/latest/api/index.html">ApplicationEventPublisher</a>. The method on line 11 is declared as transactional, saving an object and then publishing the event.</p>
<p>The method on line 17 is declared with <a href="https://github.com/micronaut-projects/micronaut-data/blob/master/data-tx/src/main/java/io/micronaut/transaction/annotation/TransactionalEventListener.java">@TransactionalEventListener</a> and for the moment just prints out the event. If the transaction fails for whatever reason, however, the event will never be received and the output never printed.</p>
<h2>Summary</h2>
<p>There is a definite lack of information on how compelling the Micronaut AOP implementation is, and I hope this blog post goes some way to resolving that. Micronaut AOP has some really nice features and makes it really simple to define AOP advice without the need to involve complex runtime bytecode generation solutions that create enormous stack traces and place additional memory strain on your application.</p>
<p>My recent experience using Micronaut AOP to build Micronaut Data further highlighted to me the advances we have made in this area, pushing developers to avoid the use of reflection, which optimizes memory consumption and makes it so much easier to go native with GraalVM substrate.</p>

        </article>
        
        
<nav class="row pager">
  
  <div class="col-6 text-right">
    
    <span class="next">
      <a href="/2019/11/21/micronaut-1-3-milestone-1-released/" rel="next">Newer post</a> 
    </span>
    
  </div>
  
  <div class="col-6 text-left">
    
    <span class="prev">
      <a href="/2019/08/19/introduction-to-micronaut-multi-tenancy/" rel="prev">Previous post</a>    </span>
    
  </div>
  
</nav>        
      </div>
      <div class="col-sm-4">
        
        <aside id="sidebar">
  
    
<h4 class="h2">You might also like ...</h4>


<article class="post" >
  
  <a href="/2025/06/30/transitioning-to-virtual-threads-using-the-micronaut-loom-carrier/">
    
    <time>June 30, 2025</time>
  
    <header>
      <h3>Transitioning to virtual threads using the Micronaut loom carrier</h3>
    </header>
    
  </a>
  
</article>
  
  <div id="tag_cloud-2" class="widget widget_tag_cloud"><h4 class="boxed first-word-bold">Post by tag</h4><div class="tagcloud"><a href="/tag/aws/" class="tag-cloud-link tag-link-85 tag-sm tag-link-position-1" style="font-size: 14.670588235294pt;" aria-label="aws (12 items)">aws</a>
<a href="/tag/azure/" class="tag-cloud-link tag-link-100 tag-sm tag-link-position-2" style="font-size: 11.294117647059pt;" aria-label="azure (4 items)">azure</a>
<a href="/tag/casestudy/" class="tag-cloud-link tag-link-126 tag-sm tag-link-position-3" style="font-size: 9.4823529411765pt;" aria-label="casestudy (2 items)">casestudy</a>
<a href="/tag/cli/" class="tag-cloud-link tag-link-106 tag-sm tag-link-position-4" style="font-size: 9.4823529411765pt;" aria-label="cli (2 items)">cli</a>
<a href="/tag/community/" class="tag-cloud-link tag-link-241 tag-sm tag-link-position-5" style="font-size: 11.294117647059pt;" aria-label="community (4 items)">community</a>
<a href="/tag/corretto/" class="tag-cloud-link tag-link-97 tag-sm tag-link-position-6" style="font-size: 9.4823529411765pt;" aria-label="corretto (2 items)">corretto</a>
<a href="/tag/data/" class="tag-cloud-link tag-link-89 tag-sm tag-link-position-7" style="font-size: 11.294117647059pt;" aria-label="data (4 items)">data</a>
<a href="/tag/docker/" class="tag-cloud-link tag-link-116 tag-sm tag-link-position-8" style="font-size: 9.4823529411765pt;" aria-label="docker (2 items)">docker</a>
<a href="/tag/foundation/" class="tag-cloud-link tag-link-102 tag-sm tag-link-position-9" style="font-size: 12.941176470588pt;" aria-label="foundation (7 items)">foundation</a>
<a href="/tag/gcp/" class="tag-cloud-link tag-link-87 tag-sm tag-link-position-10" style="font-size: 11.952941176471pt;" aria-label="gcp (5 items)">gcp</a>
<a href="/tag/graalvm/" class="tag-cloud-link tag-link-83 tag-sm tag-link-position-11" style="font-size: 13.764705882353pt;" aria-label="graalvm (9 items)">graalvm</a>
<a href="/tag/gradle/" class="tag-cloud-link tag-link-107 tag-sm tag-link-position-12" style="font-size: 12.941176470588pt;" aria-label="gradle (7 items)">gradle</a>
<a href="/tag/groovy/" class="tag-cloud-link tag-link-136 tag-sm tag-link-position-13" style="font-size: 9.4823529411765pt;" aria-label="groovy (2 items)">groovy</a>
<a href="/tag/guides/" class="tag-cloud-link tag-link-132 tag-sm tag-link-position-14" style="font-size: 9.4823529411765pt;" aria-label="guides (2 items)">guides</a>
<a href="/tag/http-client/" class="tag-cloud-link tag-link-291 tag-sm tag-link-position-15" style="font-size: 8pt;" aria-label="HTTP client (1 item)">HTTP client</a>
<a href="/tag/intellijidea/" class="tag-cloud-link tag-link-98 tag-sm tag-link-position-16" style="font-size: 10.470588235294pt;" aria-label="intellijidea (3 items)">intellijidea</a>
<a href="/tag/iot/" class="tag-cloud-link tag-link-303 tag-sm tag-link-position-17" style="font-size: 9.4823529411765pt;" aria-label="IoT (2 items)">IoT</a>
<a href="/tag/jetbrains/" class="tag-cloud-link tag-link-296 tag-sm tag-link-position-18" style="font-size: 9.4823529411765pt;" aria-label="JetBrains (2 items)">JetBrains</a>
<a href="/tag/jhipster/" class="tag-cloud-link tag-link-134 tag-sm tag-link-position-19" style="font-size: 11.294117647059pt;" aria-label="JHipster (4 items)">JHipster</a>
<a href="/tag/kotlin/" class="tag-cloud-link tag-link-115 tag-sm tag-link-position-20" style="font-size: 10.470588235294pt;" aria-label="kotlin (3 items)">kotlin</a>
<a href="/tag/lambda/" class="tag-cloud-link tag-link-339 tag-sm tag-link-position-21" style="font-size: 11.294117647059pt;" aria-label="lambda (4 items)">lambda</a>
<a href="/tag/launch/" class="tag-cloud-link tag-link-99 tag-sm tag-link-position-22" style="font-size: 11.952941176471pt;" aria-label="launch (5 items)">launch</a>
<a href="/tag/loom/" class="tag-cloud-link tag-link-490 tag-sm tag-link-position-23" style="font-size: 8pt;" aria-label="loom (1 item)">loom</a>
<a href="/tag/maven/" class="tag-cloud-link tag-link-94 tag-sm tag-link-position-24" style="font-size: 11.294117647059pt;" aria-label="maven (4 items)">maven</a>
<a href="/tag/meetup/" class="tag-cloud-link tag-link-108 tag-sm tag-link-position-25" style="font-size: 10.470588235294pt;" aria-label="meetup (3 items)">meetup</a>
<a href="/tag/microcast/" class="tag-cloud-link tag-link-109 tag-sm tag-link-position-26" style="font-size: 12.529411764706pt;" aria-label="microcast (6 items)">microcast</a>
<a href="/tag/micronaut2/" class="tag-cloud-link tag-link-103 tag-md tag-link-position-27" style="font-size: 16.4pt;" aria-label="micronaut2 (20 items)">micronaut2</a>
<a href="/tag/micronaut4/" class="tag-cloud-link tag-link-344 tag-sm tag-link-position-28" style="font-size: 12.529411764706pt;" aria-label="micronaut4 (6 items)">micronaut4</a>
<a href="/tag/micronaut-data/" class="tag-cloud-link tag-link-178 tag-sm tag-link-position-29" style="font-size: 9.4823529411765pt;" aria-label="Micronaut Data (2 items)">Micronaut Data</a>
<a href="/tag/mqtt/" class="tag-cloud-link tag-link-123 tag-sm tag-link-position-30" style="font-size: 10.470588235294pt;" aria-label="mqtt (3 items)">mqtt</a>
<a href="/tag/opentracing-api/" class="tag-cloud-link tag-link-290 tag-sm tag-link-position-31" style="font-size: 8pt;" aria-label="OpenTracing API (1 item)">OpenTracing API</a>
<a href="/tag/oracle/" class="tag-cloud-link tag-link-113 tag-sm tag-link-position-32" style="font-size: 10.470588235294pt;" aria-label="oracle (3 items)">oracle</a>
<a href="/tag/oracle-cloud/" class="tag-cloud-link tag-link-180 tag-sm tag-link-position-33" style="font-size: 10.470588235294pt;" aria-label="Oracle Cloud (3 items)">Oracle Cloud</a>
<a href="/tag/raspberry-pi/" class="tag-cloud-link tag-link-304 tag-sm tag-link-position-34" style="font-size: 9.4823529411765pt;" aria-label="Raspberry Pi (2 items)">Raspberry Pi</a>
<a href="/tag/release/" class="tag-cloud-link tag-link-80 tag-xl tag-link-position-35" style="font-size: 22pt;" aria-label="release (100 items)">release</a>
<a href="/tag/security/" class="tag-cloud-link tag-link-125 tag-sm tag-link-position-36" style="font-size: 11.952941176471pt;" aria-label="security (5 items)">security</a>
<a href="/tag/serverless/" class="tag-cloud-link tag-link-101 tag-sm tag-link-position-37" style="font-size: 9.4823529411765pt;" aria-label="serverless (2 items)">serverless</a>
<a href="/tag/servlet/" class="tag-cloud-link tag-link-91 tag-sm tag-link-position-38" style="font-size: 9.4823529411765pt;" aria-label="servlet (2 items)">servlet</a>
<a href="/tag/sponsors/" class="tag-cloud-link tag-link-253 tag-sm tag-link-position-39" style="font-size: 13.352941176471pt;" aria-label="sponsors (8 items)">sponsors</a>
<a href="/tag/springboot/" class="tag-cloud-link tag-link-84 tag-sm tag-link-position-40" style="font-size: 10.470588235294pt;" aria-label="springboot (3 items)">springboot</a>
<a href="/tag/townhall/" class="tag-cloud-link tag-link-114 tag-sm tag-link-position-41" style="font-size: 13.352941176471pt;" aria-label="townhall (8 items)">townhall</a>
<a href="/tag/training/" class="tag-cloud-link tag-link-135 tag-sm tag-link-position-42" style="font-size: 13.352941176471pt;" aria-label="training (8 items)">training</a>
<a href="/tag/video/" class="tag-cloud-link tag-link-88 tag-lg tag-link-position-43" style="font-size: 19.364705882353pt;" aria-label="video (47 items)">video</a>
<a href="/tag/webinar/" class="tag-cloud-link tag-link-81 tag-md tag-link-position-44" style="font-size: 17.058823529412pt;" aria-label="webinar (24 items)">webinar</a>
<a href="/tag/zipkin/" class="tag-cloud-link tag-link-289 tag-sm tag-link-position-45" style="font-size: 8pt;" aria-label="Zipkin (1 item)">Zipkin</a></div>
</div>  
</aside>        
      </div>
    </div>
    
  </div>
</main>

    <footer id="footer">
      <div class="container">

        <div class="row">
          <div class="col-sm-5 footer-left">
            
            <div id="text-14" class="widget widget_text">			<div class="textwidget"></div>
		</div><div id="block-3" class="widget widget_block widget_media_image">
<figure class="wp-block-image size-large"><img loading="lazy" decoding="async" width="1024" height="316" src="/wp-content/uploads/2021/10/MIcronaut_Foundation_Horizontal_white-1024x316.png" alt="" class="wp-image-4398" srcset="/wp-content/uploads/2021/10/MIcronaut_Foundation_Horizontal_white-1024x316.png 1024w, https://micronaut.io/wp-content/uploads/2021/10/MIcronaut_Foundation_Horizontal_white-300x93.png 300w, https://micronaut.io/wp-content/uploads/2021/10/MIcronaut_Foundation_Horizontal_white-768x237.png 768w, https://micronaut.io/wp-content/uploads/2021/10/MIcronaut_Foundation_Horizontal_white-150x46.png 150w, https://micronaut.io/wp-content/uploads/2021/10/MIcronaut_Foundation_Horizontal_white.png 1203w" sizes="auto, (max-width: 1024px) 100vw, 1024px" /></figure>
</div>            
          </div>
          <div class="col-sm-7 footer-right">
            
            <ul class="meta">

              <li id="menu-item-2895" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2895"><a href="/brand-guidelines/">Brand Guidelines</a></li>
<li id="menu-item-2894" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2894"><a href="/community-guidelines/">Community Code of Conduct</a></li>
<li id="menu-item-3377" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-privacy-policy menu-item-3377"><a rel="privacy-policy" href="/privacy-policy/">Privacy Policy</a></li>

            </ul>
            
            <div id="nav_menu-2" class="widget widget_nav_menu"><div class="menu-links-container"><ul id="menu-links" class="menu"><li id="menu-item-4515" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4515"><a href="mailto:info@micronaut.io"><i class="fas fa-envelope"><span class="sr-only">Mail</span></i></a></li>
<li id="menu-item-2886" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-2886"><a target="_blank" href="https://twitter.com/micronautfw"><i class="fab fa-x-twitter"><span class="sr-only">Twitter</span></i></a></li>
<li id="menu-item-6740" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-6740"><a href="https://fosstodon.org/@micronaut"><i class="fab fa-mastodon"><span class="sr-only">Mastodon</span></i></a></li>
<li id="menu-item-2888" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-2888"><a target="_blank" href="https://discord.com/invite/9xRFsHv98T"><i class="fab fa-discord"><span class="sr-only">Discord</span></i></a></li>
<li id="menu-item-2889" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-2889"><a target="_blank" href="https://github.com/micronaut-projects/"><i class="fab fa-github"><span class="sr-only">GitHub</span></i></a></li>
<li id="menu-item-2890" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-2890"><a target="_blank" href="https://www.youtube.com/@MicronautFramework"><i class="fab fa-youtube"><span class="sr-only">YouTube</span></i></a></li>
<li id="menu-item-4514" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4514"><a href="https://www.linkedin.com/showcase/micronaut"><i class="fab fa-linkedin"><span class="sr-only">LinkedIn</span></i></a></li>
<li id="menu-item-4513" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-4513"><a href="https://www.twitch.tv/micronautfw"><i class="fab fa-twitch"><span class="sr-only">Twitch</span></i></a></li>
</ul></div></div><div id="text-5" class="widget widget_text">			<div class="textwidget"><p><small>© 2024 Micronaut Foundation. All rights reserved.</small></p>
</div>
		</div>  
            
          </div>
        </div>
        
      </div>
    </footer>

    <script type="speculationrules">
{"prefetch":[{"source":"document","where":{"and":[{"href_matches":"\/*"},{"not":{"href_matches":["\/wp-*.php","\/wp-admin\/*","\/wp-content\/uploads\/*","\/wp-content\/*","\/wp-content\/plugins\/*","\/wp-content\/themes\/micronaut\/*","\/*\\?(.+)"]}},{"not":{"selector_matches":"a[rel~=\"nofollow\"]"}},{"not":{"selector_matches":".no-prefetch, .no-prefetch a"}}]},"eagerness":"conservative"}]}
</script>
<script type="text/javascript" src="/wp-content/themes/micronaut/js/script.min.js" id="micronaut-script-js"></script>

  </body>
</html><!--
Performance optimized by Redis Object Cache. Learn more: https://wprediscache.com

Retrieved 2428 objects (908 KB) from Redis using PhpRedis (v5.3.7).
-->
